{% extends 'base.html' %}
{% block content%}

    <form id='upload-form' 
    hx-encoding='multipart/form-data' 
    hx-push-url="true"
    hx-boost="true"
    enctype="multipart/form-data" 
    method="post"
    hx-on::after-request="if(event.detail.successful) { this.reset(); document.querySelector('#progress').value = 0; }"> 
       {% csrf_token %}
       {{ form.as_p }}
        <button   type="submit" >
            Upload
        </button>
        <progress id='progress' value='0' max='100'></progress>
    </form>
    <script>
        htmx.on('#upload-form', 'htmx:xhr:progress', function(evt) {
          htmx.find('#progress').setAttribute('value', evt.detail.loaded/evt.detail.total * 100)
        });
    </script>

{% endblock %}